(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"/zyf":function(e,t,n){"use strict";var r={name:"page",props:{pageSizeArray:Array,size:Number,pageTotal:Number,current:Number,nameShow:String},data:function(){return{pageCurrent:this.current}},methods:{handleSizeChange:function(e){this.$emit("handleSizeChange",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e)}},watch:{current:function(e){this.pageCurrent=e}}},a=(n("t2r+"),n("KHd+")),i=Object(a.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:"事件详情"===e.nameShow?"pageClass":"",staticStyle:{height:"20px","padding-top":"10px"}},[n("span",{staticStyle:{display:"inline-block","font-size":"13px","min-width":"35.5px",height:"28px","line-height":"30px","vertical-align":"top","box-sizing":"border-box",float:"right"}},[e._v("共"+e._s(e.pageTotal)+"条")]),e._v(" "),n("el-pagination",{staticStyle:{float:"right"},attrs:{background:"",layout:"prev, pager, next","page-size":e.size,"current-page":e.pageCurrent,total:e.pageTotal},on:{"update:currentPage":function(t){e.pageCurrent=t},"update:current-page":function(t){e.pageCurrent=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)}),[],!1,null,"40b774d6",null);t.a=i.exports},J66h:function(e,t,n){(function(n){var r;!function(n,a){e.exports=function(n){"use strict";var a,i=(n=n||{}).Base64,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(o),l=String.fromCharCode,c=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,f=function(e){return e.replace(u,c)},d=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),t>=2?"=":o.charAt(n>>>6&63),t>=1?"=":o.charAt(63&n)].join("")},m=n.btoa&&"function"==typeof n.btoa?function(e){return n.btoa(e)}:function(e){if(e.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return e.replace(/[\s\S]{1,3}/g,d)},p=function(e){return m(f(String(e)))},g=function(e){return e.replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,"")},h=function(e,t){return t?g(p(e)):p(e)};n.Uint8Array&&(a=function(e,t){for(var n="",r=0,a=e.length;r<a;r+=3){var i=e[r],s=e[r+1],l=e[r+2],c=i<<16|s<<8|l;n+=o.charAt(c>>>18)+o.charAt(c>>>12&63)+(void 0!==s?o.charAt(c>>>6&63):"=")+(void 0!==l?o.charAt(63&c):"=")}return t?g(n):n});var v,b=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,_=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},y=function(e){return e.replace(b,_)},w=function(e){var t=e.length,n=t%4,r=(t>0?s[e.charAt(0)]<<18:0)|(t>1?s[e.charAt(1)]<<12:0)|(t>2?s[e.charAt(2)]<<6:0)|(t>3?s[e.charAt(3)]:0),a=[l(r>>>16),l(r>>>8&255),l(255&r)];return a.length-=[0,0,2,1][n],a.join("")},C=n.atob&&"function"==typeof n.atob?function(e){return n.atob(e)}:function(e){return e.replace(/\S{1,4}/g,w)},k=function(e){return C(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},x=function(e){return String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,"")},S=function(e){return function(e){return y(C(e))}(x(e))};n.Uint8Array&&(v=function(e){return Uint8Array.from(k(x(e)),(function(e){return e.charCodeAt(0)}))});var A=function(){var e=n.Base64;return n.Base64=i,e};if(n.Base64={VERSION:"2.6.4",atob:k,btoa:m,fromBase64:S,toBase64:h,utob:f,encode:h,encodeURI:function(e){return h(e,!0)},btou:y,decode:S,noConflict:A,fromUint8Array:a,toUint8Array:v},"function"==typeof Object.defineProperty){var z=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",z((function(){return S(this)}))),Object.defineProperty(String.prototype,"toBase64",z((function(e){return h(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",z((function(){return h(this,!0)})))}}n.Meteor&&(Base64=n.Base64);e.exports?e.exports.Base64=n.Base64:void 0===(r=function(){return n.Base64}.apply(t,[]))||(e.exports=r);return{Base64:n.Base64}}(n)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:this)}).call(this,n("yLpj"))},TzQq:function(e,t,n){},meFd:function(e,t,n){"use strict";n.r(t);var r=n("/zyf"),a={name:"formRelation",props:{isAdd:Boolean},data:function(){return{form:{id:"",name:"",events:[],risks:[],ways:[],mobile:"",dong:"",email:""},waysList:[{label:"短信",value:"sms"},{label:"微信",value:"wechat"},{label:"咚咚",value:"dong"},{label:"邮箱",value:"email"}],eventsData:"",risksData:"",dialogVisible:!1,rules:{name:[{required:!0,message:"请输入联系人",trigger:"blur"}],ways:[{required:!0,message:"请选择通知方式",trigger:"change"}]}}},methods:{handleClose:function(){this.dialogVisible=!1,this.eventsData="",this.risksData="",this.form={}},mapArray:function(e){if(null!==e)return e.map((function(e){return e.id}))},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){t.form.events=t.eventsData.split("\n").filter((function(e){return""!==e})),t.form.risks=t.risksData.split("\n").filter((function(e){return""!==e})),e&&(t.isAdd?t.$request.fetchPostContact(t.form).then((function(){t.$message({message:"添加成功!!!",type:"success"}),t.dialogVisible=!1,t.form={},t.$parent.getContact()})).catch((function(e){t.$message.error(e.data)})):t.$request.fetchPutContact(t.form).then((function(){t.$message({message:"修改成功!!!",type:"success"}),t.dialogVisible=!1,t.form={},t.$parent.getContact()})).catch((function(e){t.$message.error(e.data)})))}))}}},i=n("KHd+"),o=Object(i.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{"before-close":e.handleClose,"el-dialog":"","close-on-click-modal":!1,visible:e.dialogVisible,title:e.isAdd?"新增告警":"编辑告警","append-to-body":"",width:"650px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,size:"small","label-width":"90px"}},[n("el-form-item",{attrs:{label:"联系人",prop:"name"}},[n("el-input",{staticStyle:{width:"100%"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"事件类型"}},[n("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.eventsData,callback:function(t){e.eventsData=t},expression:"eventsData"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"风险类型"}},[n("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.risksData,callback:function(t){e.risksData=t},expression:"risksData"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"通知方式",prop:"ways"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:e.form.ways,callback:function(t){e.$set(e.form,"ways",t)},expression:"form.ways"}},e._l(e.waysList,(function(e,t){return n("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[n("el-input",{staticStyle:{width:"100%"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"咚咚",prop:"dong"}},[n("el-input",{staticStyle:{width:"100%"},model:{value:e.form.dong,callback:function(t){e.$set(e.form,"dong",t)},expression:"form.dong"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[n("el-input",{staticStyle:{width:"100%"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v(e._s(e.isAdd?"创建":"修改"))])],1)],1)}),[],!1,null,"50045e50",null).exports,s={name:"formIgnore",props:{isAddIgnore:Boolean},data:function(){return{form:{id:"",name:"",events:[],risks:[],ways:[],mobile:"",dong:"",email:"",event_code:"",risk_code:""},ignoreShow:!1}},methods:{handleClose:function(){this.ignoreShow=!1,this.form={}},mapArray:function(e){if(null!==e)return e.map((function(e){return e.id}))},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var r=n("J66h").Base64,a=r.encode(t.form.event_code),i=r.encode(t.form.risk_code),o={id:t.form.id,name:t.form.name,events:t.form.events,risks:t.form.risks,ways:t.form.ways,mobile:t.form.mobile,dong:t.form.dong,email:t.form.email,event_code:a,risk_code:i};t.$request.fetchPutContact(o).then((function(){t.$message({message:"修改成功!!!",type:"success"}),t.ignoreShow=!1,t.form={},t.$parent.getContact()})).catch((function(e){t.$message.error(e.data)}))}}))}}},l=Object(i.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{"before-close":e.handleClose,"el-dialog":"","close-on-click-modal":!1,visible:e.ignoreShow,title:"忽略","append-to-body":"",width:"650px"},on:{"update:visible":function(t){e.ignoreShow=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,size:"small","label-width":"90px"}},[n("el-form-item",{attrs:{label:"忽略事件"}},[n("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.form.event_code,callback:function(t){e.$set(e.form,"event_code",t)},expression:"form.event_code"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"忽略风险"}},[n("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.form.risk_code,callback:function(t){e.$set(e.form,"risk_code",t)},expression:"form.risk_code"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("修改")])],1)],1)}),[],!1,null,"1ccd4652",null).exports,c={name:"index",components:{ContactForm:o,Page:r.a,FormIgnore:l},data:function(){return{pageSizeArray:[10,20,30,40],current:1,size:10,pageTotal:0,contactData:[],isAdd:!0,isAddIgnore:!0,delLoading:!1,selectInput:""}},created:function(){this.getContact()},methods:{ipRe:function(e){if(null!==e)return e.filter((function(e){if(!/(\d+)\.(\d+)\.(\d+)\.(\d+)/g.test(e))return e}))},percentageChange:function(e,t){return 0===e?0:parseInt(e/t*1e4)/100},customColorMethod:function(e,t){var n=this.percentageChange(e,t);return n<30?"#67c23a":n<70?"#e6a23c":"#f56c6c"},enableChange:function(e){var t=this,n={id:e.id,enable:e.enable,version:e.version};this.$request.fetchPatchEnable(n).then((function(){t.getRelation()}))},handleSizeChange:function(e){this.size=e,this.getRelation()},handleCurrentChange:function(e){this.current=e,this.getRelation()},addContact:function(){this.isAdd=!0,this.$refs.forms.dialogVisible=!0},subDelete:function(e){var t=this;this.$refs[e].doClose();var n=this;n.delLoading=!0,this.$request.fetchDeleteCantact(e).then((function(e){n.$message({message:"删除成功!!!",type:"success"}),n.delLoading=!1,n.getContact()})).catch((function(e){t.$message.error(e.data)}))},getContact:function(){var e=this,t={current:this.current,size:this.size,name:this.selectInput};this.$request.fetchGetContact(t).then((function(t){e.contactData=t.data.records,e.pageTotal=t.data.total}))},handleIgnore:function(e,t){this.isAddIgnore=!1;var r=this.$refs.formsIgnore,a=n("J66h").Base64;null===t.risk_code&&(t.risk_code=""),null===t.event_code&&(t.event_code=""),r.ignoreShow=!0,r.form={id:t.id,name:t.name,events:t.events,risks:t.risks,ways:t.ways,mobile:t.mobile,dong:t.dong,email:t.email,risk_code:a.decode(t.risk_code),event_code:a.decode(t.event_code)}},handleEdit:function(e,t){this.isAdd=!1;var n=this.$refs.forms;if(null!==t.risks)var r=t.risks.join("\n");if(null!==t.events)var a=t.events.join("\n");n.dialogVisible=!0,n.form={id:t.id,name:t.name,events:t.events,risks:t.risks,ways:t.ways,mobile:t.mobile,dong:t.dong,email:t.email},n.eventsData=a,n.risksData=r},handleDelete:function(e,t){this.$message({showClose:!0,message:e,row:t,type:"success"})},formatter:function(e,t){return e.address},filterTag:function(e,t){return t.tag===e},filterHandler:function(e,t,n){return t[n.property]===e}}},u=Object(i.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%"}},[n("el-card",[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-input",{staticClass:"input-with-select",staticStyle:{width:"20%"},attrs:{placeholder:"请输入名称",size:"mini"},model:{value:e.selectInput,callback:function(t){e.selectInput=t},expression:"selectInput"}}),e._v(" "),n("el-button",{staticStyle:{color:"#909399",background:"#f4f4f5","border-color":"#d3d4d6"},attrs:{icon:"el-icon-search",size:"mini"},on:{click:e.getContact}})],1),e._v(" "),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[n("el-button",{staticStyle:{"margin-left":"0"},attrs:{"el-button":"",type:"success",plain:"",size:"mini"},on:{click:e.addContact}},[e._v("添加\n        ")])],1)],1),e._v(" "),n("el-table",{staticStyle:{width:"100%","margin-top":"5px"},attrs:{data:e.contactData,border:"","header-cell-style":{color:"#909399",textAlign:"center",background:"#f5f7fa"}}},[n("el-table-column",{attrs:{prop:"name",label:"联系人"}}),e._v(" "),n("el-table-column",{attrs:{label:"风险类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.risks?n("div",{staticStyle:{width:"95%",margin:"0 auto","text-align":"left"}},[e.ipRe(t.row.risks).length<5?n("span",e._l(e.ipRe(t.row.risks),(function(t,r){return n("el-tag",{key:r,staticStyle:{"margin-right":"3px"},attrs:{type:"info",size:"mini"}},[e._v("\n                      "+e._s(t))])})),1):n("span",[e._l(e.ipRe(t.row.risks).slice(0,4),(function(t,r){return n("el-tag",{key:r,staticStyle:{"margin-right":"3px"},attrs:{type:"info",size:"mini"}},[e._v(" "+e._s(t))])})),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Right Center 提示文字",placement:"right"}},[n("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" + "+e._s(e.ipRe(t.row.risks).length))]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},e._l(e.ipRe(t.row.risks),(function(t,r){return n("span",{key:r,staticStyle:{"padding-right":"15px"}},[e._v(e._s(t)),n("br")])})),0)],1)],2)]):n("div",[e._v("\n            -\n          ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"事件类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.events?n("div",{staticStyle:{width:"95%",margin:"0 auto","text-align":"left"}},[e.ipRe(t.row.events).length<5?n("span",e._l(e.ipRe(t.row.events),(function(t,r){return n("el-tag",{key:r,staticStyle:{"margin-right":"3px"},attrs:{type:"info",size:"mini"}},[e._v("\n                      "+e._s(t))])})),1):n("span",[e._l(e.ipRe(t.row.events).slice(0,4),(function(t,r){return n("el-tag",{key:r,staticStyle:{"margin-right":"3px"},attrs:{type:"info",size:"mini"}},[e._v(" "+e._s(t))])})),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Right Center 提示文字",placement:"right"}},[n("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(" + "+e._s(e.ipRe(t.row.events).length))]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},e._l(e.ipRe(t.row.events),(function(t,r){return n("span",{key:r,staticStyle:{"padding-right":"15px"}},[e._v(e._s(t)),n("br")])})),0)],1)],2)]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"方式"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.ways,(function(t,r){return n("el-tag",{key:r,staticStyle:{"margin-right":"3px"},attrs:{type:"info",size:"mini"}},[e._v("\n            "+e._s(t)+"\n          ")])}))}}])}),e._v(" "),n("el-table-column",{attrs:{label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticStyle:{width:"50%","text-align":"left"}},[""!==t.row.email?n("p",[n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("邮箱："+e._s(t.row.email))])],1):e._e(),e._v(" "),""!==t.row.mobile?n("p",[n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("手机："+e._s(t.row.mobile))])],1):e._e(),e._v(" "),""!==t.row.dong?n("p",[n("el-tag",{attrs:{type:"info",size:"mini"}},[e._v("咚咚："+e._s(t.row.dong))])],1):e._e()])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{staticStyle:{"text-align":"right",margin:"0"},attrs:{size:"mini"},on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑\n          ")]),e._v(" "),n("el-button",{staticStyle:{"text-align":"right",margin:"0"},attrs:{size:"mini"},on:{click:function(n){return e.handleIgnore(t.$index,t.row)}}},[e._v("忽略\n          ")]),e._v(" "),n("el-popover",{ref:t.row.id,attrs:{placement:"top"}},[n("p",[e._v("确定删除?")]),e._v(" "),n("div",[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){e.$refs[t.row.id].doClose()}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{loading:e.delLoading,type:"primary",size:"mini"},on:{click:function(n){return e.subDelete(t.row.id)}}},[e._v("确定\n              ")])],1),e._v(" "),n("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",size:"mini"},slot:"reference"})],1)]}}])})],1),e._v(" "),n("Page",{attrs:{size:e.size,current:e.current,pageTotal:e.pageTotal,pageSizeArray:e.pageSizeArray},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1),e._v(" "),n("ContactForm",{ref:"forms",attrs:{"is-add":e.isAdd}}),e._v(" "),n("FormIgnore",{ref:"formsIgnore",attrs:{isAddIgnore:e.isAddIgnore}})],1)}),[],!1,null,null,null);t.default=u.exports},"t2r+":function(e,t,n){"use strict";n("TzQq")}}]);
//# sourceMappingURL=33.e49f20198bccd1462f4f.js.map