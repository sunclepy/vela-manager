(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"2CBm":function(t,e,a){"use strict";a("C86p")},C86p:function(t,e,a){},I98R:function(t,e,a){"use strict";a.r(e);var i=a("25l2"),s=a("jxM8"),n=a("hJFz"),l=a("/zyf"),r=a("ThUY"),o=(a("vQJo"),a("N0jg")),c={components:{Page:l.a,selectSearch:r.a,addService:n.a,NodeDetail:o.a,Event:s.a},name:"taskDetail",props:["dataTasks"],data:function(){return{drawerEvent:!1,eventDetailShow:!1,tableLoading:!1,topEchartShow:!1,initData:{},currentPage:1,pageSize:13,delLoading:!1,ipTtitel:{},drawer:!1,directions:"rtl",dataTask:{},processShow:!1,processDetailData:{},pageSizeArray:["10","20","30","40"],searchName:"",condData:{},startTime:null,endTime:null,value:"",operator:"",field:"",filters:[],activeIndex:null,nameShow:"事件详情"}},created:function(){this.getCond()},methods:{eventShow:function(){this.$emit("activeClick",!0,!1,!1)},riskShow:function(){this.$emit("activeClick",!1,!1,!0)},closeEvent:function(t){this.drawerEvent=t},attackShow:function(){this.$emit("activeClick",!0,!1)},echartShow:function(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow")},drawerClose:function(){this.drawer=!1,this.ipTtitel={}},innetactive:function(t){this.ipTtitel=t,this.drawer=!0},getCond:function(){var t=this;this.$request.fetchTaskCond().then((function(e){t.condData=e.data}))},searchBasic:function(t){this.currentPage=1,this.filters=t,this.init()},init:function(){var t=this;this.tableLoading=!0;var e={current:this.currentPage,size:this.pageSize,filters:this.filters};this.$request.fetchGetTask(e).then((function(e){t.tableLoading=!1,t.initData=e.data}))},handleSizeChange:function(t){this.pageSize=t,this.init()},handleCurrentChange:function(t){this.currentPage=t,this.init()},reloadService:function(t){var e=this,a={id:t.minion_id,substance_id:t.substance_id,dialect:t.dialect};this.$request.fetchPatchReload(a).then((function(t){e.$message.success("重启成功！！")})).catch((function(t){e.$message.error(t.data)}))},handleEvent:function(t){this.eventDetailShow=!0,this.dataTask=t,this.drawerEvent=!0},handleEdit:function(t){var e=this,i=this.$refs.formAdd;this.$request.fetchdetailDialect(t.minion_id,t.substance_id).then((function(e){var s=a("J66h").Base64;i.serverData=e.data,i.dataTask=t,e.data.chunk?i.dialogValue=s.decode(e.data.chunk):i.dialogValue=s.decode(" "),i.form={id:e.data.id,icon:e.data.icon,chunk:e.data.chunk,version:e.data.version},i.codeName=e.data.name,i.linkArray=e.data.links,i.dialogVisible=!0})).catch((function(t){e.$message.error(t.data)}))},delCode:function(t){var e=this;this.$refs[t].doClose();var a=this;a.delLoading=!0,this.$request.fetchDeleteCodeEdit(t).then((function(){a.$message({message:"删除成功!!!",type:"success"}),a.delLoading=!1,a.init()})).catch((function(t){a.delLoading=!1,e.$message.error(t.data)}))},addService:function(){var t=this.$refs.addService;t.form.minion_id=this.$route.params.id,t.serverVisible=!0},searchAdd:function(t,e){this.currentPage=1;var a,i=this.$refs.select;this.activeAdd=[{key:t.key,value:e,operator:"eq"}],a=[{key:t,value:e,operator:{desc:"等于",key:"eq"}}],i.filtersshow=a,this.filters=this.activeAdd,this.init()},resync:function(){var t=this;this.$request.fetchBatch({cmd:"resync",filters:[]}).then((function(e){t.$message({message:"同步成功!!!",type:"success"})})).catch((function(e){t.$message.error(e.data)}))},getNode:function(){this.init()},refresh:function(){this.init(),this.$message({message:"已刷新",type:"success"})},detailData:function(t){this.$message({message:"开发中！！！",type:"warning"})},processCancel:function(){this.processDetailData={},this.processShow=!1}}},d=(a("qEkT"),a("KHd+")),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-col",{attrs:{span:5,clas:"namdf"}},[a("el-button-group",[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.eventShow}},[t._v("事件")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("终端")]),t._v(" "),a("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.riskShow}},[t._v("风险")])],1)],1),t._v(" "),a("el-col",{attrs:{span:19}},[a("select-search",{ref:"select",staticStyle:{"text-align":"right"},attrs:{condData:t.condData,defaultData:t.dataTasks,nameIndex:"任务详情"},on:{searchBasic:t.searchBasic,refresh:t.refresh}})],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.initData.records,"cell-style":{padding:"0px",background:"#303133",color:"#86909c"},"header-cell-style":{background:"#303133",color:"#f2f6fca8",fontWeight:"600",fontSize:"14px"}}},[a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["console"===e.row.from?a("span",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"scope.row.error",placement:"bottom"}},[e.row.status?a("span",[a("span",{staticClass:"circle_content"},[a("span",{class:"running"===e.row.status?"running":"error"===e.row.status?"error":"other"})]),t._v("\n"+t._s(e.row.status)+"\n                     "),a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px",color:"#3d95ff",cursor:"pointer"},on:{click:function(a){return t.searchAdd({key:"status",desc:"运行状态"},e.row.status)}}})]):a("span",[t._v("未知\n                ")])])],1):a("span",[e.row.status?a("span",[a("span",{staticClass:"circle_content"},[a("span",{class:"running"===e.row.status?"running":"error"===e.row.status?"error":"other"})]),t._v("\n"+t._s(e.row.status)+"\n             "),a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px",color:"#3d95ff",cursor:"pointer"},on:{click:function(a){return t.searchAdd({key:"status",desc:"运行状态"},e.row.status)}}})]):a("span",[t._v("未知\n              ")])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"inet",label:"终端IP",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.inet)+"\n          "),a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px",color:"#3d95ff",cursor:"pointer"},on:{click:function(a){t.searchAdd({key:"inet",desc:"节点 IPv4"},e.row.inet)}}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.report_hash!==e.row.hash?a("span",{staticStyle:{color:"red"}},[t._v("\n                 "+t._s(e.row.name)),a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px",color:"#3d95ff",cursor:"pointer"},on:{click:function(a){return t.searchAdd({key:"name",desc:"配置名称"},e.row.name)}}}),t._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:"下发的配置与数据库中的配置校验不一致",placement:"right"}},[a("i",{staticClass:"fa fa-exclamation-circle"})])],1):a("span",[t._v("\n                "+t._s(e.row.name)),a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-left":"5px",color:"#3d95ff",cursor:"pointer"},on:{click:function(a){return t.searchAdd({key:"name",desc:"配置名称"},e.row.name)}}})])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"from",label:"来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.from?a("span",[t._v(t._s(e.row.from))]):a("span",[t._v("未知")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"dialect",label:"属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(!0===e.row.dialect?"私有":"公有")+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"link",label:"外链"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.link?a("span",[t._v(t._s(e.row.link))]):a("span",[t._v("无")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("date")(e.row.created_at,"yyyy-MM-dd hh:mm:ss"))+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"right",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["console"!==e.row.from?a("span",[a("el-button",{staticStyle:{color:"#4175b3"},attrs:{size:"mini",type:"text"},on:{click:function(a){return t.handleEvent(e.row)}}},[t._v("事件")]),t._v(" "),a("el-button",{staticStyle:{color:"#4175b3"},attrs:{size:"mini",type:"text"},on:{click:function(a){return t.reloadService(e.row)}}},[t._v("重启")])],1):t._e(),t._v(" "),e.row.dialect&&"startup"!==e.row.name?a("el-popover",{ref:e.row.substance_id,attrs:{placement:"top"}},[a("p",[t._v("确定删除?")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){t.$refs[e.row.substance_id].doClose()}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.delLoading,type:"primary",size:"mini"},on:{click:function(a){return t.delCode(e.row.substance_id)}}},[t._v("确定\n              ")])],1),t._v(" "),a("el-button",{staticStyle:{"margin-left":"3%",color:"#4175b3"},attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[t._v("删除")])],1):a("span",{staticStyle:{color:"#c0c4cc","margin-left":"3%"}},[t._v("删除")])]}}])})],1),t._v(" "),a("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.initData.total,pageSizeArray:t.pageSizeArray,nameShow:t.nameShow},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),t._v(" "),a("el-drawer",{staticClass:"eventDrawer",attrs:{visible:t.processShow,direction:"rtl",size:"25%"},on:{"update:visible":function(e){t.processShow=e},close:t.processCancel}},[a("div",{staticStyle:{padding:"0  20px"}},[a("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"controlCard",staticStyle:{"font-size":"12px"}},[t._v("进程详情")])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("进程名称\n                "),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.name))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("内存使用"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.mem_size||"-"))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("进程PID"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.pid))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("进程PPID"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.ppid))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("用户信息"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.username))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("处理字节"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.rss_bytes||"-"))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("启动时间"),a("span",{staticClass:"subtitle"},[t._v(t._s(t._f("date")(t.processDetailData.created_at,"yyyy-MM-dd hh:mm:ss")))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("启动参数"),a("span",{staticClass:"subtitle"},[t.processDetailData.args?a("span",[t.processDetailData.args.length>0?a("span",t._l(t.processDetailData.args,(function(e,i){return a("span",{key:i},[a("el-tag",{staticStyle:{"margin-right":"10px"},attrs:{type:"info",size:"mini"}},[t._v(t._s(e))])],1)})),0):t._e()]):a("span",[t._v("-")])])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("启动命令"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.cmdline||"-"))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("进程路径"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.executable||"-"))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("checksum"),a("span",{staticClass:"subtitle"},[t._v(t._s(t.processDetailData.checksum||"-"))])])],1)],1)])]),t._v(" "),a("addService",{ref:"addService",on:{getNode:t.getNode}}),t._v(" "),t.eventDetailShow?a("Event",{ref:"eventDetail",attrs:{drawerEvent:t.drawerEvent,dataTask:t.dataTask},on:{closeEvent:t.closeEvent}}):t._e(),t._v(" "),a("el-drawer",{attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[a("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1)],1)}),[],!1,null,"5f822f92",null).exports,p=a("/qbm"),v=a("Qb+X"),h={name:"risk",components:{Page:l.a,selectSearch:r.a,CvssScore:v.a,NodeDetail:o.a,CodeEdit:p.default},props:["dataTasks"],data:function(){return{nameShow:"事件详情",form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},groupArray:[{key:"risk_type",desc:"类型"},{key:"level",desc:"级别"},{key:"status",desc:"状态"},{key:"inet",desc:"终端IP"},{key:"from_code",desc:"任务名称"}],condData:{},riskLoading:!1,actionType:["批量删除","批量忽略","批量处理"],actionTitle:"",colData:[{lable:"终端IP",key:"inet",istrue:!0,width:150},{lable:"主题",key:"subject",istrue:!0},{lable:"等级",key:"level",istrue:!0,width:100},{lable:"源IP",key:"local_ip",istrue:!1,width:150},{lable:"源端口",key:"local_port",istrue:!1,width:150},{lable:"外部IP",key:"remote_ip",istrue:!0,width:150},{lable:"外部端口",key:"remote_port",istrue:!0},{lable:"地理位置",key:"region",istrue:!1},{lable:"类型",key:"risk_type",istrue:!0,width:100},{lable:"攻击载荷",key:"payload",istrue:!1},{lable:"告警",key:"send_alert",istrue:!1},{lable:"产生时间",key:"occur_at",istrue:!0},{lable:"任务名称",key:"from_code",istrue:!0},{lable:"参考信息",key:"reference",istrue:!1}],tableHeader:[{title:"终端IP",istrue:!0},{title:"类型",istrue:!0},{title:"等级",istrue:!0},{title:"源IP",istrue:!1},{title:"源端口",istrue:!1},{title:"外部端口",istrue:!0},{title:"外部IP",istrue:!0},{title:"地理位置",istrue:!0},{title:"主题",istrue:!0},{title:"攻击载荷",istrue:!1},{title:"告警",istrue:!1},{title:"产生时间",istrue:!0},{title:"任务名称",istrue:!0},{title:"参考信息",istrue:!1}],colOptions:["终端IP","类型","等级",,"远程IP","目的端口","目的IP","主题","产生时间","任务名称"],colSelect:["终端IP","类型","等级","源IP","源端口","目的端口","目的IP","地理位置","主题","攻击载荷","告警","产生时间","任务名称","参考信息"],riskData:[],currentPage:1,pageSize:14,vulnDetailShow:!1,vulnDetailData:{},ipTtitel:{},drawer:!1,directions:"rtl",noticedirections:"rtl",filters:[],noticeShow:!1,pageTotal:0,topEchartShow:!1,contactData:[]}},created:function(){this.getCond()},computed:{activeUsers:function(){return this.colData.filter((function(t){return t.istrue}))}},methods:{refresh:function(){this.initRisk(),this.$message({message:"已刷新",type:"success"})},taskShow:function(){this.$emit("activeClick",!1,!0,!1)},eventShow:function(){this.$emit("activeClick",!0,!1,!1)},selectActive:function(t){this.$emit("activeClick",!1,!1,!0,t)},cancel:function(){this.actionTitle=""},bulkClick:function(t){this.$refs.actionForm.actionDialog=!0,this.actionTitle=t},drawerClose:function(){this.drawer=!1,this.ipTtitel={}},noticeClose:function(){this.noticeShow=!1},innetactive:function(t){this.ipTtitel=t,this.drawer=!0},activeCode:function(t){var e=this,i=this.$refs.formAdd;this.$request.fetchdetailDialect(t.minion_id,"",t.from_code).then((function(e){var s=a("J66h").Base64;i.serverData=e.data,i.dataTask=t,e.data.chunk?i.dialogValue=s.decode(e.data.chunk):i.dialogValue=s.decode(" "),i.form={id:e.data.id,icon:e.data.icon,chunk:e.data.chunk,version:e.data.version},i.codeName=e.data.name,i.linkArray=e.data.links,i.dialogVisible=!0})).catch((function(t){e.$message.error(t.data)}))},attackShow:function(){this.$emit("activeClick",!1,!0,!1)},initRisk:function(){var t=this,e={current:this.currentPage,size:this.pageSize,filters:this.filters};this.riskLoading=!0,this.$request.fetchRisks(e).then((function(e){t.riskData=e.data.records,t.pageTotal=e.data.total,t.riskLoading=!1}))},getCond:function(){var t=this;this.$request.fetchRisksCond().then((function(e){t.condData=e.data}))},searchBasic:function(t){this.currentPage=1,this.filters=t,this.initRisk()},echartShow:function(){this.topEchartShow=!this.topEchartShow,this.$emit("activechartShow",this.topEchartShow)},sheetode:function(){var t={filters:this.filters};this.$request.fetchSheetode(t).then((function(t){var e=document.createElement("a"),a=new Blob([t.data],{type:"text/csv"});e.style.display="none",e.href=URL.createObjectURL(a);var i=t.headers["content-disposition"].split("''");e.setAttribute("download",decodeURI(i[1])),document.body.appendChild(e),e.click(),document.body.removeChild(e)}))},handleSizeChange:function(t){this.pageSize=t,this.initRisk()},handleCurrentChange:function(t){this.currentPage=t,this.initRisk()},riskDetailCilck:function(t){this.vulnDetailShow=!0,this.vulnDetailData=t},riskNoticeCilck:function(){var t=this;this.noticeShow=!0;this.$request.fetchGetContact({current:1,size:100,name:""}).then((function(e){t.contactData=e.data.records}))},kaifa:function(){this.$message({message:"开发中！！！",type:"warning"})},vulnmDetailCancel:function(){this.vulnDetailShow=!1,this.vulnDetailData={}},click:function(){this.$message({message:"开发中！！！",type:"warning"})}},watch:{colOptions:function(t){if(t){var e=this.colSelect.filter((function(e){return t.indexOf(e)<0}));this.colData.filter((function(t){e.indexOf(t.lable)>-1?t.istrue=!1:t.istrue=!0}))}}}},f=(a("lcis"),{props:["dataTask"],components:{Risk:Object(d.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{attrs:{span:6}},[a("el-button-group",{staticClass:"primary"},[a("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.eventShow}},[t._v("事件")]),t._v(" "),a("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.taskShow}},[t._v("终端")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("风险")])],1)],1),t._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("select-search",{attrs:{condData:t.condData,nameIndex:"风险详情",defaultData:t.dataTasks},on:{searchBasic:t.searchBasic,refresh:t.refresh}})],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.riskLoading,expression:"riskLoading"}],staticStyle:{"margin-top":"3px"},attrs:{data:t.riskData,"cell-style":{padding:"0px",background:"#303133",color:"#86909c"},"header-cell-style":{background:"#303133",color:"#f2f6fca8",fontWeight:"600",fontSize:"14px"},stripe:"",align:"center"}},[t._l(t.activeUsers,(function(e,i){return a("el-table-column",{key:i,attrs:{"show-overflow-tooltip":"",label:e.lable,prop:e.key,width:e.width},scopedSlots:t._u([{key:"default",fn:function(i){return["inet"===e.key?a("span",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.innetactive(i.row)}}},[t._v(t._s(i.row.inet))])],1):"level"===e.key?a("span",[a("CvssScore",{attrs:{cvssScore:i.row.level}})],1):"region"===e.key?a("span",[t._v("\n             "+t._s(i.row.region||"0|0|0|未知|未知")+"\n          ")]):"remote_ip"===e.key?a("span",[t._v("\n             "+t._s(i.row.remote_ip||"未知")+"\n          ")]):"send_alert"===e.key?a("span",[t._v("\n               "+t._s(!0===i.row[e.key]?"是":"否")+"\n          ")]):"occur_at"===e.key?a("span",[t._v("\n                "+t._s(t._f("date")(i.row.occur_at,"yyyy-MM-dd hh:mm:ss"))+"\n          ")]):"payload"===e.key||"reference"===e.key?a("pre",[t._v(t._s(i.row.payload))]):a("span",[t._v("\n          "+t._s(i.row[e.key])+"\n        ")])]}}],null,!0)})})),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.riskDetailCilck(e.row)}}},[t._v("详情")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.riskNoticeCilck()}}},[t._v("通知")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:t.kaifa}},[t._v("处理")])]}},{key:"header",fn:function(e){return[a("el-popover",{attrs:{placement:"bottom",trigger:"click"}},[t._l(t.tableHeader,(function(e,i){return a("div",{key:i},[a("el-checkbox",{attrs:{label:e.title},model:{value:t.colOptions,callback:function(e){t.colOptions=e},expression:"colOptions"}})],1)})),t._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[t._v("操作"),a("i",{staticClass:"el-icon-setting",staticStyle:{"padding-left":"10px"}})])],2)]}}])})],2),t._v(" "),a("Page",{attrs:{size:t.pageSize,current:t.currentPage,pageTotal:t.pageTotal,nameShow:t.nameShow},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}}),t._v(" "),a("el-drawer",{staticClass:"vulnDrawer",attrs:{title:t.vulnDetailData.inet,visible:t.vulnDetailShow,direction:"rtl",size:"35%","append-to-body":!0},on:{"update:visible":function(e){t.vulnDetailShow=e},close:t.vulnmDetailCancel}},[a("div",{staticStyle:{padding:"0  20px"}},[a("span",{staticStyle:{"font-size":"13px",color:"#86909c","font-weight":"bold"}},[a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("等级"),a("span",{staticClass:"subtitle"},["无风险"===t.vulnDetailData.level?a("el-tag",{attrs:{type:"success",size:"mini"}},[a("span",[t._v("无风险")])]):t._e(),t._v(" "),"低危"===t.vulnDetailData.level?a("el-tag",{attrs:{type:"",size:"mini"}},[a("span",[t._v("低危")])]):t._e(),t._v(" "),"中危"===t.vulnDetailData.level?a("el-tag",{staticStyle:{color:"#adad24","background-color":"#ffff0161","border-color":"#d9d92461"},attrs:{size:"mini"}},[a("span",[t._v("中危")])]):t._e(),t._v(" "),"高危"===t.vulnDetailData.level?a("el-tag",{attrs:{type:"warning",size:"mini"}},[a("span",[t._v("高危")])]):t._e(),t._v(" "),"紧急"===t.vulnDetailData.level?a("el-tag",{attrs:{type:"danger",size:"mini"}},[a("span",[t._v("紧急")])]):t._e()],1)])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("告警："),a("span",{staticClass:"subtitle"},[t._v(t._s(!0===t.vulnDetailData.send_alert?"是":"否"))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("类型："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.risk_type))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("主题："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.subject))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("源IP："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.local_ip))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("源端口："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.local_port))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("外部IP："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.remote_ip))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("外部端口："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.remote_port))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("任务名称："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.from_code))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("地理位置："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.region))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("创建时间："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.created_at))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[t._v("产生时间："),a("span",{staticClass:"subtitle"},[t._v(t._s(t.vulnDetailData.occur_at))])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{float:"left"}},[t._v("参考信息：")]),a("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[a("pre",{staticStyle:{"font-family":"none"}},[t._v(t._s(t.vulnDetailData.reference||"-"))])])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-bottom":"14px"}},[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{float:"left"}},[t._v("攻击载荷：")]),a("span",{staticClass:"subtitle",staticStyle:{float:"left"}},[a("pre",{staticStyle:{"font-family":"none"}},[t._v(t._s(t.vulnDetailData.payload||"-"))])])])],1)],1)])]),t._v(" "),a("el-drawer",{staticClass:"inetDrawer",attrs:{title:t.ipTtitel.inet,visible:t.drawer,direction:t.directions,"before-close":t.drawerClose,size:"90%"},on:{"update:visible":function(e){t.drawer=e}}},[a("node-detail",{ref:"ipDetail",attrs:{minionId:t.ipTtitel.minion_id}})],1),t._v(" "),a("el-drawer",{attrs:{title:"事件通知",visible:t.noticeShow,"append-to-body":!0,direction:t.noticedirections,"custom-class":"demo-drawer","before-close":t.noticeClose,size:"20%"},on:{"update:visible":function(e){t.noticeShow=e}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-form",{attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"联系人","label-width":"80px"}},[a("el-select",{staticStyle:{width:"71%"},attrs:{size:"mini"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},t._l(t.contactData,(function(t,e){return a("el-option",{key:e,attrs:{lable:t.name,value:t.name}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"通知方式","label-width":"80px"}},[a("el-checkbox-group",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[a("el-checkbox",{attrs:{label:"邮件",name:"type"}}),t._v(" "),a("el-checkbox",{attrs:{label:"短信",name:"type"}}),t._v(" "),a("el-checkbox",{attrs:{label:"咚咚",name:"type"}}),t._v(" "),a("el-checkbox",{attrs:{label:"电话",name:"type"}}),t._v(" "),a("el-checkbox",{attrs:{label:"微信",name:"type"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"demo-drawer__footer"},[a("el-button",{staticStyle:{float:"right",margin:"10px"},attrs:{type:"primary"}},[t._v("发送")])],1)],1)]),t._v(" "),a("CodeEdit",{ref:"formAdd",on:{handleEdit:t.activeCode}})],1)}),[],!1,null,"5af9f774",null).exports,Event:i.a,Task:u},name:"eventTask",data:function(){return{evnetShow:!0,taskShow:!1,riskShow:!1}},methods:{activeClick:function(t,e,a){this.evnetShow=t,this.taskShow=e,this.riskShow=a}}}),_=Object(d.a)(f,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.evnetShow?a("Event",{attrs:{dataTask:t.dataTask},on:{activeClick:t.activeClick}}):t._e(),t._v(" "),t.taskShow?a("Task",{attrs:{dataTasks:t.dataTask},on:{activeClick:t.activeClick}}):t._e(),t._v(" "),t.riskShow?a("Risk",{attrs:{dataTasks:t.dataTask},on:{activeClick:t.activeClick}}):t._e()],1)}),[],!1,null,"13497276",null);e.default=_.exports},"Qb+X":function(t,e,a){"use strict";var i={name:"CvssScore",props:["cvssScore"]},s=(a("2CBm"),a("KHd+")),n=Object(s.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[4===t.cvssScore||"紧急"===t.cvssScore?a("div",{staticStyle:{height:"24px",margin:"0 auto"}},[a("div",{staticClass:"severity-critical-bg text-pull"},[a("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[a("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._v(" "),t._m(0)]):t._e(),t._v(" "),3===t.cvssScore||"高危"===t.cvssScore?a("div",{staticStyle:{height:"24px"}},[a("div",{staticClass:"severity-high-bg text-pull"},[a("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[a("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._v(" "),t._m(1)]):t._e(),t._v(" "),2===t.cvssScore||"中危"===t.cvssScore?a("div",{staticStyle:{height:"24px"}},[a("div",{staticClass:"severity-medium-bg text-pull"},[a("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[a("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._v(" "),t._m(2)]):t._e(),t._v(" "),1===t.cvssScore||"低危"===t.cvssScore?a("div",{staticStyle:{height:"24px"}},[a("div",{staticClass:"severity-low-bg text-pull"},[a("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[a("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._v(" "),t._m(3)]):t._e(),t._v(" "),0===t.cvssScore||"无风险"===t.cvssScore?a("div",{staticStyle:{height:"24px"}},[a("div",{staticClass:"severity-no-bg text-pull"},[a("svg",{staticClass:"icon",attrs:{fill:"#fff",t:"1658471401691",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2218"}},[a("path",{attrs:{d:"M906.496819 314.75159 767.929904 314.75159c-22.190395-38.46301-52.763714-71.749114-89.50143-96.65127l80.132038-80.132038-69.77618-69.77618L581.529563 175.444824c-22.190395-5.424546-45.613874-8.629541-69.529563-8.629541-23.916712 0-47.339168 3.204995-69.529563 8.629541L335.215668 68.191078l-69.77618 69.77618 80.132038 80.132038c-36.737716 24.902156-67.311035 58.18826-89.50143 96.65127L117.503181 314.750567l0 98.624205 103.062284 0c-2.711761 16.025998-4.438079 32.546254-4.438079 49.312102l0 49.312102-98.624205 0 0 98.624205 98.624205 0 0 49.312102c0 16.765849 1.726318 33.286104 4.438079 49.312102L117.503181 709.247386l0 98.624205 138.566916 0c51.03842 88.268346 146.456606 147.936307 255.929904 147.936307S716.891484 896.14096 767.929904 807.872614l138.566916 0 0-98.624205L803.434535 709.24841c2.711761-16.025998 4.438079-32.546254 4.438079-49.312102l0-49.312102 98.624205 0 0-98.624205-98.624205 0 0-49.312102c0-16.765849-1.726318-33.286104-4.438079-49.312102l103.062284 0L906.496819 314.75159zM610.624205 709.24841 413.375795 709.24841l0-98.624205 197.24841 0L610.624205 709.24841zM610.624205 512 413.375795 512l0-98.624205 197.24841 0L610.624205 512z","p-id":"2219"}})])]),t._v(" "),t._m(4)]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[this._v("紧急")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[this._v("高危")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[this._v("中危")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[this._v("低危")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-pull-center",staticStyle:{height:"24px"}},[e("div",{staticStyle:{"font-size":"12px","padding-left":"8px"}},[e("span",{staticClass:"severity-value",staticStyle:{"text-align":"center"}},[this._v("无风险")])])])}],!1,null,"77d4d761",null);e.a=n.exports},Rqck:function(t,e,a){},Sh9U:function(t,e,a){},lcis:function(t,e,a){"use strict";a("Sh9U")},qEkT:function(t,e,a){"use strict";a("Rqck")}}]);
//# sourceMappingURL=5.d3b65072f8b4eb8aaeb0.js.map